Table with the total number of reads and the mapping rate for each sample

read.csv("C:\\Users\\Alasi\\Downloads\\table.csv")

tx2gene = read.csv("tx2gene.csv",
                     header=F,
                     sep=",")

tx2gene$V1<- gsub("\\..*","",tx2gene$V1)
tx2gene$V2<- gsub("\\..*","",tx2gene$V2)
head (tx2gene)

txi = tximport(files,
               type="salmon",
               tx2gene=tx2gene,
               txOut=TRUE)
samples = data.frame(sample_names=sample_names,
                     condition=sample_condition)

row.names(samples) = sample_names
library("DESeq2")
ddsTxi = DESeqDataSetFromTximport(txi,
                                  colData = samples,
                                  design = ~ condition)
print(ddsTxi)
keep = rowSums(counts(ddsTxi)) >=10 #filter data
ddsTxi = ddsTxi[keep,]
ddsTxi = DESeq(ddsTxi)

rld = rlog(ddsTxi) #PCA
plotPCA(object = rld)
estimateDispersions(ddsTxi, fitType = "parametric")
plotDispEsts(object = ddsTxi, 
             main="Dispersion-by-Mean plot")

res = results(ddsTxi, contrast = c('condition',
                                   'control',
                                   'treated'))
write.table(res,file = "DE_Seq2_res_ALL_genes.txt", sep = "\t")
 
plotMA(res,
       ylim = c(-6,6),
       main = "Control vs Treated")
resshrunk = lfcShrink(ddsTxi, contrast = c('condition',
                                            'control',
                                            'treated'), type = "ashr")
plotMA(resshrunk,
       ylim = c(-6,6),
       main = "Control vs Treated (Shrunk)")
resshrunk = resshrunk[complete.cases(resshrunk),] # remove NAs

resshrunk_ordered = resshrunk[order(resshrunk$padj),]

library('ggplot2') #Raw p-value histogram
ggplot(as.data.frame(resshrunk_ordered),aes(pvalue)) + geom_histogram(fill="light blue",color='black')
Table with the 10 most highly significant differentially expressed genes

head(resshrunk_ordered, n = 10) 
The number of statistically relevant differentially expressed genes using 0.05 false discovery rate

resshrunk_fdr = resshrunk_ordered[resshrunk_ordered$padj<=0.05,]
summary(resshrunk_fdr)
The number of biologically relevant differentially expressed genes with a gene expression two fold or greater

resshrunk_fdr.cut_1 = resshrunk_fdr[resshrunk_fdr$log2FoldChange>=1,]
resshrunk_fdr.cut_2 = resshrunk_fdr[resshrunk_fdr$log2FoldChange<= -1,]

diffexp_genes = c(row.names(resshrunk_fdr.cut_1), row.names(resshrunk_fdr.cut_2))  

summary(diffexp_genes)
